## Input file for PETSc implicit CH-2D solver

# Grid

-da_grid_x 64
-da_grid_y 64
-Lx 1.0
-Ly 1.0

# Initial conditions
-initial_temperature_file initial_temperature.bin
-initial_temperature_source_file initial_temperature_source.bin
-initial_soln_file initial_soln.bin

# CH parameters
-CH_m 0.1
-D_T 0.00001
-physics coupled_ch_thermal

# Boundary conditions

-boundary_ch neumann
-boundary_thermal neumann
-dirichlet_bc 0.0
-dirichlet_bc_thermal 0.1
-dirichlet_bc_ch_array_file none
-dirichlet_bc_thermal_array_file none

# Temporal scheme

-time_stepper implicit
-dt 0.00001
-ts_type beuler
# -ts_type arkimex
-ts_adapt_type basic
-ts_adapt_dt_max 0.1
-ts_max_snes_failures -1
-t_final 1.0
-dt_check 0.04
-dt_output 0.04

# Petsc solver options

## GMRES SETTINGS
-pc_type asm
-ksp_type gmres

## MULTIGRID SETTINGS
# -pc_type gamg
# -ksp_type fgmres
# -mg_levels_pc_type asm
# -mg_levels_ksp_type richardson
# -mg_levels_ksp_max_it 1

## COMMON SOLVER SETTINGS
-ksp_gmres_restart 200
-ksp_atol 1e-9
-ksp_rtol 1e-2
-snes_atol 1e-8
-snes_rtol 1e-3

# Solver monitors

-ts_monitor
-ts_monitor_draw_solution
# -log_view :log.out
-ts_monitor_lg_snes_iterations
-ts_monitor_lg_ksp_iterations
# -snes_monitor
# -ksp_monitor
# -snes_linesearch_monitor
# -ts_adapt_monitor
# -draw_pause .1

#-on_error_attach_debugger
#-start_in_debugger